import{d as h,g as v,f as o,o as u,m as G,P as y,n as c,u as a,ag as j,ah as q,a7 as z,_ as A,U as L,S as Q,ai as $,aj as O,ak as W,I as H,al as J,am as K,an as M,ao as X,ap as Y,i as m,c as r,k as n,aq as Z,a as f,ar as ee,as as ae,at as le,au as se,av as te,aw as ne,ax as oe,z as ue,af as b,ay as re}from"./index-ede2aed2.js";import{u as fe}from"./usePageTitle-649cd0a6.js";const pe={class:"flow-run-graphs__graphs"},de={class:"flow-run-graphs__panel p-background"},ce=h({__name:"FlowRunGraphs",props:{flowRun:{}},setup(k){const d=v(),p=v(!1),e=v(null),i=o(()=>({root:{"flow-run-graphs--fullscreen":p.value,"flow-run-graphs--show-panel":!!e.value}}));return(_,t)=>(u(),G("div",{class:z(["flow-run-graphs",i.value.root])},[y("div",pe,[c(a(j),{fullscreen:p.value,"onUpdate:fullscreen":t[0]||(t[0]=s=>p.value=s),viewport:d.value,"onUpdate:viewport":t[1]||(t[1]=s=>d.value=s),selected:e.value,"onUpdate:selected":t[2]||(t[2]=s=>e.value=s),"flow-run":_.flowRun,class:"flow-run-graphs__flow-run"},null,8,["fullscreen","viewport","selected","flow-run"])]),y("div",de,[c(a(q),{node:e.value,"onUpdate:node":t[3]||(t[3]=s=>e.value=s),floating:p.value},null,8,["node","floating"])])],2))}});const _e=h({__name:"FlowRun",setup(k){const d=A(),p=L("flowRunId");Q();const{flowRun:e,subscription:i}=$(p,{interval:5e3}),_=o(()=>{var l;return(l=e.value)==null?void 0:l.deploymentId}),{deployment:t}=O(_),s=o(()=>{var l;return(l=e.value)!=null&&l.stateType?W(e.value.stateType):!0}),F=o(()=>[{label:"Logs"},{label:"Task Runs",hidden:s.value},{label:"Subflow Runs",hidden:s.value},{label:"Results",hidden:s.value},{label:"Artifacts",hidden:s.value},{label:"Details"},{label:"Parameters"}]),w=H("tab","Logs"),{tabs:I}=J(F,w),x=o(()=>{var l;return((l=e.value)==null?void 0:l.parameters)??{}}),S=o(()=>{var l;return((l=t.value)==null?void 0:l.parameterOpenApiSchema)??{}}),g=o(()=>K(x.value,S.value)),T=o(()=>[p.value]),{filter:U}=M({flowRuns:{parentFlowRunId:T}});function B(){d.push(b.flowRuns())}const C=o(()=>{var l;return(l=e.value)==null?void 0:l.stateType});X(C);const P=o(()=>e.value?`Flow Run: ${e.value.name}`:"Flow Run");return fe(P),Y(()=>{i.error&&re(i.error).isInRange("clientError")&&d.replace(b[404]())}),(l,R)=>{const D=m("p-code-highlight"),N=m("p-tabs"),V=m("p-layout-default");return u(),r(V,{class:"flow-run"},{header:n(()=>[a(e)?(u(),r(a(Z),{key:0,"flow-run-id":a(e).id,onDelete:B},null,8,["flow-run-id"])):f("",!0)]),default:n(()=>[a(e)&&!s.value?(u(),r(ce,{key:0,"flow-run":a(e)},null,8,["flow-run"])):f("",!0),c(N,{selected:a(w),"onUpdate:selected":R[0]||(R[0]=E=>ue(w)?w.value=E:null),tabs:a(I)},{details:n(()=>[a(e)?(u(),r(a(ee),{key:0,"flow-run":a(e)},null,8,["flow-run"])):f("",!0)]),logs:n(()=>[a(e)?(u(),r(a(ae),{key:0,"flow-run":a(e)},null,8,["flow-run"])):f("",!0)]),results:n(()=>[a(e)?(u(),r(a(le),{key:0,"flow-run":a(e)},null,8,["flow-run"])):f("",!0)]),artifacts:n(()=>[a(e)?(u(),r(a(se),{key:0,"flow-run":a(e)},null,8,["flow-run"])):f("",!0)]),"task-runs":n(()=>[a(e)?(u(),r(a(te),{key:0,"flow-run-id":a(e).id},null,8,["flow-run-id"])):f("",!0)]),"subflow-runs":n(()=>[c(a(ne),{filter:a(U)},null,8,["filter"])]),parameters:n(()=>[a(e)?(u(),r(a(oe),{key:0,"text-to-copy":g.value},{default:n(()=>[c(D,{lang:"json",text:g.value,class:"flow-run__parameters"},null,8,["text"])]),_:1},8,["text-to-copy"])):f("",!0)]),_:1},8,["selected","tabs"])]),_:1})}}});export{_e as default};
